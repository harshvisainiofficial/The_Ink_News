{% extends "base.html" %}

{% block title %}खोज - द इंक न्यूज़{% endblock %}

{% block content %}
<h2>खोज</h2>
<div class="search-bar">
    <form action="{{ url_for('search') }}" method="get">
        <input type="text" name="q" value="{{ query | safe }}" placeholder="समाचार खोजें..." style="padding: 8px; width: 300px; font-size: 1em; border: 1px solid #ccc; border-radius: 4px;">
        <button type="submit" style="padding: 8px 16px; font-size: 1em; border: 1px solid #ccc; border-radius: 4px; background-color: #f8f8f8; cursor: pointer;">खोजें</button>
    </form>
</div>
<div class="news-articles">
    {% if news_articles %}
        {% for article in news_articles %}
            <article>
                <h3><a href="{{ url_for('news_detail', id=article.id) }}">{{ article.title | safe }}</a></h3>
                <p><strong>शहर:</strong> {{ article.location }}</p>
                {% if article.location_text %}
                    <p><strong>स्थान:</strong> {{ article.location_text }}</p>
                {% endif %}
                <p><strong>तारीख:</strong> {{ article.date_published.strftime('%Y-%m-%d') }}</p>
                {% set first_image = article.content_blocks|selectattr('block_type', 'equalto', 'image')|selectattr('content')|first %}
                {% if first_image and first_image.content %}
                    <a href="{{ url_for('news_detail', id=article.id) }}">
                        <img src="{{ first_image.content }}?f_auto,q_auto" alt="{{ article.title | safe }}" class="preview-image" style="max-width: 100%; margin: 10px 0;" loading="lazy">
                    </a>
                {% endif %}
                {% set first_text = article.content_blocks|selectattr('block_type', 'equalto', 'text')|selectattr('content')|first %}
                {% if first_text %}
                    <p>{{ first_text.content|truncate(100) | safe }} <a href="{{ url_for('news_detail', id=article.id) }}">और पढ़ें...</a></p>
                {% endif %}
            </article>
        {% endfor %}
    {% else %}
        <p>कोई समाचार नहीं मिला{% if query %} "{{ query }}" के लिए{% endif %}।</p>
    {% endif %}
</div>
{% endblock %}